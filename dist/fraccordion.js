(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Fraccordion = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var Collapsible = {

	toggleSelector: document.querySelectorAll('[data-collapsible-toggle]'),
	accordionAttr: 'data-accordion',
	toggleTextAttr: 'data-collapsible-text',
	prefix: 'collapsible-',

	init: function init() {
		// check for querySelector and addEventListener support
		if ('querySelector' in document && 'addEventListener' in window) {
			// call to build if collapsibles on page
			if (Collapsible.toggleSelector.length) {
				Collapsible.buildAll();
			}
		}
	},

	// children height helper
	findChildHeight: function findChildHeight($this) {
		var totalHeight = 0;
		for (var i = 0; i < $this.children.length; i++) {
			totalHeight += Utilities.getOuterHeight($this.children[i]);
		}
		return totalHeight;
	},

	buildAll: function buildAll() {
		// loop through collapsibles
		for (var i = 0; i < Collapsible.toggleSelector.length; i++) {
			// store element
			var $this = Collapsible.toggleSelector[i],
			    $thisContent = Utilities.getNextSibling($this);

			// add aria to content
			Collapsible.addAria($thisContent, i);
			// create buttons and callback to bind clicks
			Collapsible.createButton($this, i, Collapsible.bindClickEvents);
		}
	},

	createButton: function createButton($this, i, callback) {
		// build button element with appropriate aria attrs
		var buttonElement = document.createElement('button');
		buttonElement.innerHTML = $this.innerHTML;
		buttonElement.setAttribute('aria-expanded', false);
		buttonElement.setAttribute('aria-controls', Collapsible.prefix + i);
		// append in place of text
		$this.innerHTML = '';
		$this.appendChild(buttonElement);
		// run callback
		callback(buttonElement);
	},

	addAria: function addAria($this, i) {
		// attach id and aria to content
		$this.id = Collapsible.prefix + i;
		$this.setAttribute('aria-hidden', true);
	},

	bindClickEvents: function bindClickEvents($this) {
		// add click event listener
		Utilities.addEventListener($this, 'click', function () {
			Collapsible.toggleEvent($this);
		});
	},

	toggleEvent: function toggleEvent($this) {
		// work out if state is open or closed
		// test accordion attribute and store parent element
		var state = $this.getAttribute('aria-expanded') === 'false' ? true : false,
		    $parentAccordion = Utilities.parentElementWithAttribute($this, Collapsible.accordionAttr),
		    isAccordion = !!$parentAccordion;

		// check if stateful and accordion
		if (state && isAccordion) {
			// find open siblings
			var $openToggle = $parentAccordion.querySelector('[aria-expanded="true"]');
			// if there are, close them
			if (!!$openToggle) {
				Collapsible.toggleState($openToggle, !state);
			}
		}
		// toggle state of clicked item to open
		Collapsible.toggleState($this, state);
	},

	toggleState: function toggleState($this, state) {
		// store respective content element and content height
		var $thisParent = $this.parentNode,
		    $thisContent = Utilities.getNextSibling($this.parentNode),
		    contentHeight = state ? Collapsible.findChildHeight($thisContent) : 0,
		    buttonText = $this.innerHTML,
		    newButtonText = $thisParent.getAttribute(Collapsible.toggleTextAttr);

		// set aria states, styles to toggle content
		$this.setAttribute('aria-expanded', state);
		$thisContent.setAttribute('aria-hidden', !state);
		// swap button text if required
		if (newButtonText) {
			$this.innerHTML = newButtonText;
			$thisParent.setAttribute(Collapsible.toggleTextAttr, buttonText);
		}
		// run animation (think about wrapping in rAF if supported?)
		$thisContent.style.height = contentHeight + 'px';
	}

};

var Utilities = {

	addEventListener: function addEventListener(el, eventName, handler) {
		if (el.addEventListener) {
			el.addEventListener(eventName, handler);
		} else {
			el.attachEvent('on' + eventName, function () {
				handler.call(el);
			});
		}
	},

	// some browsers treat empty white-spaces or new lines as text nodes
	getNextSibling: function getNextSibling(el) {
		var nextSiblingElement = el.nextSibling;
		// loop over nextSiblings until non-text node (1) found
		while (nextSiblingElement.nodeType !== 1) {
			nextSiblingElement = nextSiblingElement.nextSibling;
		}
		return nextSiblingElement;
	},

	// offsetHeight won't include margins - use this as $(el).outerHeight(true) equivalent
	getOuterHeight: function getOuterHeight(el) {
		// store height and style object
		var height = el.offsetHeight;
		var style = el.currentStyle || getComputedStyle(el);
		// increase element height with vertical margins
		height += parseInt(style.marginTop, 10) + parseInt(style.marginBottom, 10);
		return height;
	},

	parentElementWithAttribute: function parentElementWithAttribute(el, attr) {
		// set up loop to test if element has parent with attribute
		// recursive, returns boolean
		var parent = el.parentNode;
		while (parent !== document.body) {
			if (parent.hasAttribute(attr)) {
				return parent;
			} else {
				parent = parent.parentNode;
			}
		}
		return null;
	}

};

// called from doc.ready()
Collapsible.init();

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJfY29tcG9uZW50c1xcYWNjb3JkaW9uXFxhY2NvcmRpb24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQUksV0FBVyxHQUFHOztBQUVqQixlQUFjLEVBQUUsUUFBUSxDQUFDLGdCQUFnQixDQUFDLDJCQUEyQixDQUFDO0FBQ3RFLGNBQWEsRUFBRSxnQkFBZ0I7QUFDL0IsZUFBYyxFQUFFLHVCQUF1QjtBQUN2QyxPQUFNLEVBQUUsY0FBYzs7QUFFdEIsS0FBSSxFQUFFLGdCQUFXOztBQUVoQixNQUFJLGVBQWUsSUFBSSxRQUFRLElBQUksa0JBQWtCLElBQUksTUFBTSxFQUFFOztBQUVoRSxPQUFJLFdBQVcsQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFO0FBQ3RDLGVBQVcsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUN2QjtHQUNEO0VBQ0Q7OztBQUdELGdCQUFlLEVBQUUseUJBQVMsS0FBSyxFQUFFO0FBQ2hDLE1BQUksV0FBVyxHQUFHLENBQUMsQ0FBQztBQUNwQixPQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDL0MsY0FBVyxJQUFJLFNBQVMsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0dBQzNEO0FBQ0QsU0FBTyxXQUFXLENBQUM7RUFDbkI7O0FBRUQsU0FBUSxFQUFFLG9CQUFXOztBQUVwQixPQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsV0FBVyxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7O0FBRTNELE9BQUksS0FBSyxHQUFHLFdBQVcsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO09BQ3hDLFlB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QUM7QUFDM0UsU0FBTyxNQUFNLENBQUM7RUFDZDs7QUFFRCwyQkFBMEIsRUFBRSxvQ0FBUyxFQUFFLEVBQUUsSUFBSSxFQUFFOzs7QUFHOUMsTUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQztBQUMzQixTQUFPLE1BQU0sS0FBSyxRQUFRLENBQUMsSUFBSSxFQUFFO0FBQ2hDLE9BQUksTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRTtBQUM5QixXQUFPLE1BQU0sQ0FBQztJQUNkLE1BQU07QUFDTixVQUFNLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQztJQUMzQjtHQUNEO0FBQ0QsU0FBTyxJQUFJLENBQUM7RUFDWjs7Q0FFRDs7O0FBQUMsQUFHRixXQUFXLENBQUMsSUFBSSxFQUFFLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIENvbGxhcHNpYmxlID0ge1xyXG5cclxuXHR0b2dnbGVTZWxlY3RvcjogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtY29sbGFwc2libGUtdG9nZ2xlXScpLFxyXG5cdGFjY29yZGlvbkF0dHI6ICdkYXRhLWFjY29yZGlvbicsXHJcblx0dG9nZ2xlVGV4dEF0dHI6ICdkYXRhLWNvbGxhcHNpYmxlLXRleHQnLFxyXG5cdHByZWZpeDogJ2NvbGxhcHNpYmxlLScsXHJcblxyXG5cdGluaXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly8gY2hlY2sgZm9yIHF1ZXJ5U2VsZWN0b3IgYW5kIGFkZEV2ZW50TGlzdGVuZXIgc3VwcG9ydFxyXG5cdFx0aWYgKCdxdWVyeVNlbGVjdG9yJyBpbiBkb2N1bWVudCAmJiAnYWRkRXZlbnRMaXN0ZW5lcicgaW4gd2luZG93KSB7XHJcblx0XHRcdC8vIGNhbGwgdG8gYnVpbGQgaWYgY29sbGFwc2libGVzIG9uIHBhZ2VcclxuXHRcdFx0aWYgKENvbGxhcHNpYmxlLnRvZ2dsZVNlbGVjdG9yLmxlbmd0aCkge1xyXG5cdFx0XHRcdENvbGxhcHNpYmxlLmJ1aWxkQWxsKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9LFxyXG5cclxuXHQvLyBjaGlsZHJlbiBoZWlnaHQgaGVscGVyXHJcblx0ZmluZENoaWxkSGVpZ2h0OiBmdW5jdGlvbigkdGhpcykge1xyXG5cdFx0dmFyIHRvdGFsSGVpZ2h0ID0gMDtcclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgJHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dG90YWxIZWlnaHQgKz0gVXRpbGl0aWVzLmdldE91dGVySGVpZ2h0KCR0aGlzLmNoaWxkcmVuW2ldKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0b3RhbEhlaWdodDtcclxuXHR9LFxyXG5cclxuXHRidWlsZEFsbDogZnVuY3Rpb24oKSB7XHJcblx0XHQvLyBsb29wIHRocm91Z2ggY29sbGFwc2libGVzXHJcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IENvbGxhcHNpYmxlLnRvZ2dsZVNlbGVjdG9yLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdC8vIHN0b3JlIGVsZW1lbnRcclxuXHRcdFx0dmFyICR0aGlzID0gQ29sbGFwc2libGUudG9nZ2xlU2VsZWN0b3JbaV0sXHJcblx0XHRcdFx0JHRoaXNDb250ZW50ID0gVXRpbGl0aWVzLmdldE5leHRTaWJsaW5nKCR0aGlzKTtcclxuXHJcblx0XHRcdC8vIGFkZCBhcmlhIHRvIGNvbnRlbnRcclxuXHRcdFx0Q29sbGFwc2libGUuYWRkQXJpYSgkdGhpc0NvbnRlbnQsIGkpO1xyXG5cdFx0XHQvLyBjcmVhdGUgYnV0dG9ucyBhbmQgY2FsbGJhY2sgdG8gYmluZCBjbGlja3NcclxuXHRcdFx0Q29sbGFwc2libGUuY3JlYXRlQnV0dG9uKCR0aGlzLCBpLCBDb2xsYXBzaWJsZS5iaW5kQ2xpY2tFdmVudHMpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdGNyZWF0ZUJ1dHRvbjogZnVuY3Rpb24oJHRoaXMsIGksIGNhbGxiYWNrKSB7XHJcblx0XHQvLyBidWlsZCBidXR0b24gZWxlbWVudCB3aXRoIGFwcHJvcHJpYXRlIGFyaWEgYXR0cnNcclxuXHRcdHZhciBidXR0b25FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcblx0XHRidXR0b25FbGVtZW50LmlubmVySFRNTCA9ICR0aGlzLmlubmVySFRNTDtcclxuXHRcdGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgZmFsc2UpO1xyXG5cdFx0YnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCBDb2xsYXBzaWJsZS5wcmVmaXggKyBpKTtcclxuXHRcdC8vIGFwcGVuZCBpbiBwbGFjZSBvZiB0ZXh0XHJcblx0XHQkdGhpcy5pbm5lckhUTUwgPSAnJztcclxuXHRcdCR0aGlzLmFwcGVuZENoaWxkKGJ1dHRvbkVsZW1lbnQpO1xyXG5cdFx0Ly8gcnVuIGNhbGxiYWNrXHJcblx0XHRjYWxsYmFjayhidXR0b25FbGVtZW50KTtcclxuXHR9LFxyXG5cclxuXHRhZGRBcmlhOiBmdW5jdGlvbigkdGhpcywgaSkge1xyXG5cdFx0Ly8gYXR0YWNoIGlkIGFuZCBhcmlhIHRvIGNvbnRlbnRcclxuXHRcdCR0aGlzLmlkID0gQ29sbGFwc2libGUucHJlZml4ICsgaTtcclxuXHRcdCR0aGlzLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcclxuXHR9LFxyXG5cclxuXHRiaW5kQ2xpY2tFdmVudHM6IGZ1bmN0aW9uKCR0aGlzKSB7XHJcblx0XHQvLyBhZGQgY2xpY2sgZXZlbnQgbGlzdGVuZXJcclxuXHRcdFV0aWxpdGllcy5hZGRFdmVudExpc3RlbmVyKCR0aGlzLCAnY2xpY2snLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0Q29sbGFwc2libGUudG9nZ2xlRXZlbnQoJHRoaXMpO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHJcblx0dG9nZ2xlRXZlbnQ6IGZ1bmN0aW9uKCR0aGlzKSB7XHJcblx0XHQvLyB3b3JrIG91dCBpZiBzdGF0ZSBpcyBvcGVuIG9yIGNsb3NlZFxyXG5cdFx0Ly8gdGVzdCBhY2NvcmRpb24gYXR0cmlidXRlIGFuZCBzdG9yZSBwYXJlbnQgZWxlbWVudFxyXG5cdFx0dmFyIHN0YXRlID0gKCR0aGlzLmdldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcpID09PSAnZmFsc2UnKSA/IHRydWUgOiBmYWxzZSxcclxuXHRcdFx0JHBhcmVudEFjY29yZGlvbiA9IFV0aWxpdGllcy5wYXJlbnRFbGVtZW50V2l0aEF0dHJpYnV0ZSgkdGhpcywgQ29sbGFwc2libGUuYWNjb3JkaW9uQXR0ciksXHJcblx0XHRcdGlzQWNjb3JkaW9uID0gISEkcGFyZW50QWNjb3JkaW9uO1xyXG5cclxuXHRcdC8vIGNoZWNrIGlmIHN0YXRlZnVsIGFuZCBhY2NvcmRpb25cclxuXHRcdGlmIChzdGF0ZSAmJiBpc0FjY29yZGlvbikge1xyXG5cdFx0XHQvLyBmaW5kIG9wZW4gc2libGluZ3NcclxuXHRcdFx0dmFyICRvcGVuVG9nZ2xlID0gJHBhcmVudEFjY29yZGlvbi5xdWVyeVNlbGVjdG9yKCdbYXJpYS1leHBhbmRlZD1cInRydWVcIl0nKTtcclxuXHRcdFx0Ly8gaWYgdGhlcmUgYXJlLCBjbG9zZSB0aGVtXHJcblx0XHRcdGlmICghISRvcGVuVG9nZ2xlKSB7XHJcblx0XHRcdFx0Q29sbGFwc2libGUudG9nZ2xlU3RhdGUoJG9wZW5Ub2dnbGUsICFzdGF0ZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdC8vIHRvZ2dsZSBzdGF0ZSBvZiBjbGlja2VkIGl0ZW0gdG8gb3BlblxyXG5cdFx0Q29sbGFwc2libGUudG9nZ2xlU3RhdGUoJHRoaXMsIHN0YXRlKTtcclxuXHR9LFxyXG5cclxuXHR0b2dnbGVTdGF0ZTogZnVuY3Rpb24oJHRoaXMsIHN0YXRlKSB7XHJcblx0XHQvLyBzdG9yZSByZXNwZWN0aXZlIGNvbnRlbnQgZWxlbWVudCBhbmQgY29udGVudCBoZWlnaHRcclxuXHRcdHZhciAkdGhpc1BhcmVudCA9ICR0aGlzLnBhcmVudE5vZGUsXHJcblx0XHRcdCR0aGlzQ29udGVudCA9IFV0aWxpdGllcy5nZXROZXh0U2libGluZygkdGhpcy5wYXJlbnROb2RlKSxcclxuXHRcdFx0Y29udGVudEhlaWdodCA9IChzdGF0ZSkgPyBDb2xsYXBzaWJsZS5maW5kQ2hpbGRIZWlnaHQoJHRoaXNDb250ZW50KSA6IDAsXHJcblx0XHRcdGJ1dHRvblRleHQgPSAkdGhpcy5pbm5lckhUTUwsXHJcblx0XHRcdG5ld0J1dHRvblRleHQgPSAkdGhpc1BhcmVudC5nZXRBdHRyaWJ1dGUoQ29sbGFwc2libGUudG9nZ2xlVGV4dEF0dHIpO1xyXG5cclxuXHRcdC8vIHNldCBhcmlhIHN0YXRlcywgc3R5bGVzIHRvIHRvZ2dsZSBjb250ZW50XHJcblx0XHQkdGhpcy5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBzdGF0ZSk7XHJcblx0XHQkdGhpc0NvbnRlbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICFzdGF0ZSk7XHJcblx0XHQvLyBzd2FwIGJ1dHRvbiB0ZXh0IGlmIHJlcXVpcmVkXHJcblx0XHRpZiAobmV3QnV0dG9uVGV4dCkge1xyXG5cdFx0XHQkdGhpcy5pbm5lckhUTUwgPSBuZXdCdXR0b25UZXh0O1xyXG5cdFx0XHQkdGhpc1BhcmVudC5zZXRBdHRyaWJ1dGUoQ29sbGFwc2libGUudG9nZ2xlVGV4dEF0dHIsIGJ1dHRvblRleHQpO1xyXG5cdFx0fVxyXG5cdFx0Ly8gcnVuIGFuaW1hdGlvbiAodGhpbmsgYWJvdXQgd3JhcHBpbmcgaW4gckFGIGlmIHN1cHBvcnRlZD8pXHJcblx0XHQkdGhpc0NvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY29udGVudEhlaWdodCArICdweCc7XHJcblx0fVxyXG5cclxufTtcclxuXHJcbnZhciBVdGlsaXRpZXMgPSB7XHJcblxyXG5cdGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKGVsLCBldmVudE5hbWUsIGhhbmRsZXIpIHtcclxuXHRcdGlmIChlbC5hZGRFdmVudExpc3RlbmVyKSB7XHJcblx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGVsLmF0dGFjaEV2ZW50KCdvbicgKyBldmVudE5hbWUsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGhhbmRsZXIuY2FsbChlbCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH0sXHJcblxyXG5cdC8vIHNvbWUgYnJvd3NlcnMgdHJlYXQgZW1wdHkgd2hpdGUtc3BhY2VzIG9yIG5ldyBsaW5lcyBhcyB0ZXh0IG5vZGVzXHJcblx0Z2V0TmV4dFNpYmxpbmc6IGZ1bmN0aW9uKGVsKSB7XHJcblx0XHR2YXIgbmV4dFNpYmxpbmdFbGVtZW50ID0gZWwubmV4dFNpYmxpbmc7XHJcblx0XHQvLyBsb29wIG92ZXIgbmV4dFNpYmxpbmdzIHVudGlsIG5vbi10ZXh0IG5vZGUgKDEpIGZvdW5kXHJcblx0XHR3aGlsZSAobmV4dFNpYmxpbmdFbGVtZW50Lm5vZGVUeXBlICE9PSAxKSB7XHJcblx0XHRcdG5leHRTaWJsaW5nRWxlbWVudCA9IG5leHRTaWJsaW5nRWxlbWVudC5uZXh0U2libGluZztcclxuXHRcdH1cclxuXHRcdHJldHVybiBuZXh0U2libGluZ0VsZW1lbnQ7XHJcblx0fSxcclxuXHJcblx0Ly8gb2Zmc2V0SGVpZ2h0IHdvbid0IGluY2x1ZGUgbWFyZ2lucyAtIHVzZSB0aGlzIGFzICQoZWwpLm91dGVySGVpZ2h0KHRydWUpIGVxdWl2YWxlbnRcclxuXHRnZXRPdXRlckhlaWdodDogZnVuY3Rpb24oZWwpIHtcclxuXHRcdC8vIHN0b3JlIGhlaWdodCBhbmQgc3R5bGUgb2JqZWN0XHJcblx0XHR2YXIgaGVpZ2h0ID0gZWwub2Zmc2V0SGVpZ2h0O1xyXG5cdFx0dmFyIHN0eWxlID0gZWwuY3VycmVudFN0eWxlIHx8IGdldENvbXB1dGVkU3R5bGUoZWwpO1xyXG5cdFx0Ly8gaW5jcmVhc2UgZWxlbWVudCBoZWlnaHQgd2l0aCB2ZXJ0aWNhbCBtYXJnaW5zXHJcblx0XHRoZWlnaHQgKz0gcGFyc2VJbnQoc3R5bGUubWFyZ2luVG9wLCAxMCkgKyBwYXJzZUludChzdHlsZS5tYXJnaW5Cb3R0b20sIDEwKTtcclxuXHRcdHJldHVybiBoZWlnaHQ7XHJcblx0fSxcclxuXHJcblx0cGFyZW50RWxlbWVudFdpdGhBdHRyaWJ1dGU6IGZ1bmN0aW9uKGVsLCBhdHRyKSB7XHJcblx0XHQvLyBzZXQgdXAgbG9vcCB0byB0ZXN0IGlmIGVsZW1lbnQgaGFzIHBhcmVudCB3aXRoIGF0dHJpYnV0ZVxyXG5cdFx0Ly8gcmVjdXJzaXZlLCByZXR1cm5zIGJvb2xlYW5cclxuXHRcdHZhciBwYXJlbnQgPSBlbC5wYXJlbnROb2RlO1xyXG5cdFx0d2hpbGUgKHBhcmVudCAhPT0gZG9jdW1lbnQuYm9keSkge1xyXG5cdFx0XHRpZiAocGFyZW50Lmhhc0F0dHJpYnV0ZShhdHRyKSkge1xyXG5cdFx0XHRcdHJldHVybiBwYXJlbnQ7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHJcbn07XHJcblxyXG4vLyBjYWxsZWQgZnJvbSBkb2MucmVhZHkoKVxyXG5Db2xsYXBzaWJsZS5pbml0KCk7XHJcbiJdfQ==
